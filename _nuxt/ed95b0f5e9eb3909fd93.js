(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{181:function(e){e.exports=JSON.parse('["2019-typhoon-19.json","2019-chiba-typhoon-15.json"]')},182:function(e){e.exports=JSON.parse('{"map_id":"2019-chiba-typhoon-15","map_title":"印刷できる台風災害支援情報マップ（千葉県）","map_description":"SNSで流れる給水所等の情報をネットを見れない地域の人にも伝えられるよう、印刷に最適化したマップです。マップを必要な地域のところに調整すると、A4サイズにちょうどよく印刷され、かつ必要な場所の情報がリストとして表示されます。（GS・給水・避難所・充電・無料Wifi）  ぜひ印刷して必要な人に届けてあげてください！","map_image":"ogp_2019-chiba-typhoon-15.png","sources":[{"url":"https://www.google.com/maps/d/kml?mid=18v4csEC-qPW_aeXhEnuzgMfUAqWcbF5q&forcekml=1","type":"kml","title":"2019千葉台風15号","show":true}],"default_hash":"35.034970230243786,139.83536606997205-34.998870264553034,139.90144296563784","center":[139.83536606997205,35.034970230243786],"type":"KML","layer_settings":{"GS(赤：無事)":{"color":"#992222","bg_color":"#CA9491","icon_class":"fas fa-heart","class":"layer_gs_ok"},"GS (黒点：未確認)":{"color":"#4F4F5A","bg_color":"#B7B7BE","icon_class":"fas fa-eye-slash","class":"layer_gs_undefined"},"給水所_(千葉市・県指定除く）":{"color":"#285797","bg_color":"#A3BBDA","icon_class":"fas fa-tint","class":"layer_water_chibacity"},"避難所":{"color":"#276445","bg_color":"#A4C1B0","icon_class":"fas fa-street-view","class":"layer_temporary_houses"},"携帯充電_ほか":{"color":"#6D4615","bg_color":"#C1B17E","icon_class":"fas fa-plug","class":"layer_charger"},"無料Wifi":{"color":"#604490","bg_color":"#BDB1D8","icon_class":"fas fa-wifi","class":"layer_wifi"}}}')},183:function(e){e.exports=JSON.parse('{"map_id":"2019-typhoon-19","map_title":"2019年台風19号災害支援情報マップ","map_description":"SNSで流れる給水所等の情報をネットを見れない地域の人にも伝えられるよう、印刷に最適化したマップです。マップを必要な地域のところに調整すると、A4サイズにちょうどよく印刷され、かつ必要な場所の情報がリストとして表示されます。随時情報更新していきます。ぜひ印刷して必要な人に届けてあげてください！","map_image":"ogp_2019-typhoon-19.png","sources":[{"url":"https://www.google.com/maps/d/kml?mid=1pl0sY4TmNur6xB4bKvxxvi5rsizCY1bu&forcekml=1","link":"https://www.google.com/maps/d/u/0/viewer?mid=1pl0sY4TmNur6xB4bKvxxvi5rsizCY1bu","updated_search_key":{"type":"regexp","pattern":"<!\\\\[CDATA\\\\[(<br>)*(.+?)<br>","index":2,"field":"description"},"type":"kml","title":"全国","show":true},{"url":"https://www.google.com/maps/d/kml?mid=1rAKfJOHRj7K8KkaAGEAwN4RGTABs9zIt&forcekml=1","link":"https://www.google.com/maps/d/u/0/viewer?mid=1rAKfJOHRj7K8KkaAGEAwN4RGTABs9zIt","type":"kml","title":"千葉県流山市のみ","show":true}],"default_hash":"35.89575594927511,139.65994077606268-35.62491040699955,140.1995505107742","center":[140.1099463905179,35.77029301432708],"type":"KML","layer_settings":{"GS (黒点：未確認)":{"color":"#4F4F5A","bg_color":"#B7B7BE","icon_class":"fas fa-eye-slash","class":"layer_gs_undefined"},"避難所_台風19号_19年10月":{"name":"避難所_台風19号_19年10月","color":"#276445","bg_color":"#A4C1B0","icon_class":"fas fa-street-view","class":"layer_temporary_houses"},"携帯充電_ショップ(緑点；未確認)":{"color":"#6D4615","bg_color":"#C1B17E","icon_class":"fas fa-plug","class":"layer_charger"},"自主避難所":{"name":"自主避難所(流山市版)","color":"#276445","bg_color":"#A4C1B0","icon_class":"fas fa-street-view","class":"layer_temporary_houses"},"docomo 無料WIFI":{"color":"#992222","bg_color":"#CA9491","icon_class":"fas fa-wifi","class":"layer_wifi-docomo"},"Softbank 無料WIFI":{"color":"#666666","bg_color":"#B1B6B9","icon_class":"fas fa-wifi","class":"layer_wifi-sb"}}}')},184:function(e,t,n){var map={"./2019-chiba-typhoon-15":182,"./2019-chiba-typhoon-15.json":182,"./2019-typhoon-19":183,"./2019-typhoon-19.json":183,"./list":181,"./list.json":181};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(map,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return map[e]}r.keys=function(){return Object.keys(map)},r.resolve=o,e.exports=r,r.id=184},186:function(e,t,n){e.exports=n.p+"img/f04d18c.png"},195:function(e,t,n){"use strict";n.r(t),n.d(t,"DEFAULT_ICON_COLOR",(function(){return m})),n.d(t,"default",(function(){return f})),n.d(t,"readCategoryOfFolder",(function(){return _}));n(110);var r=n(41),o=(n(58),n(113),n(196)),l=n(197),c=n(103),d=n(198),m="lightgreen",f=function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,[{key:"parse",value:function(e,data,t,n){switch(e){case"kml":var r=(new DOMParser).parseFromString(data,"text/xml");return this.loadKMLData(r,t,n);case"umal":this.loadUmapJsonData(data)}}},{key:"addFeatureCollection",value:function(e,t){e.features.forEach((function(e){e.geometry.type}))}},{key:"loadUmapJsonData",value:function(data){data.layers.forEach((function(e){e._umap_options;e.features.forEach((function(e){}))}))}},{key:"loadKMLData",value:function(data,e,t){var n=data.getElementsByTagName("Folder");0==n.length&&(n=data.getElementsByTagName("Document"));var r="";if(null!=t&&"regexp"==t.type){var o=data.getElementsByTagName(t.field);if(o.length>0){var text=o[0].innerHTML,l=new RegExp(t.pattern,"iu").exec(text);null!=l&&l.length>1&&(r="("+l[t.index]+")")}}var c=[];return Array.prototype.forEach.call(n,(function(e){var t=_(e,data).name;if("FeatureCollection"==d.kml(e).type){var n=d.kml(e,{styles:!0});if(n.features.length>0)return n.features.map((function(e){"Point"==e.geometry.type&&c.push({feature:e,category:t})}))}else{var r=d.kml(e,{styles:!0});c.push({geojsondata:r,category:t})}})),[c,r]}},{key:"inBounds",value:function(e,t){var n=(e[0]-t.getNorthEast().lng)*(e[0]-t.getSouthWest().lng)<0,r=(e[1]-t.getNorthEast().lat)*(e[1]-t.getSouthWest().lat)<0;return n&&r}},{key:"convertCategoryStyle",value:function(e,t){return null==t?e:(t.forEach((function(t){if(t.name==e.name)return e.color=t.color,e.bgColor=t.bg_color,e.iconClass=t.icon_class,e.class=t.class,e})),e)}},{key:"serializeLatLng",value:function(e){return e.lat+","+e.lng}},{key:"serializeBounds",value:function(e){return this.serializeLatLng(e.getNorthWest())+"-"+this.serializeLatLng(e.getSouthEast())}},{key:"deserializeLatLng",value:function(s){var e=s.split(",",2),t=Object(r.a)(e,2),n=t[0],o=t[1],l=parseFloat(o),d=parseFloat(n);return new c.LngLat(l,d)}},{key:"deserializeBounds",value:function(s){try{var e=this;return new c.LngLatBounds(s.split("-",2).map((function(t){return e.deserializeLatLng(t)})))}catch(e){return}}}]),e}();function _(e,t){var n=e.getElementsByTagName("name")[0].textContent,r="red";console.log(e);try{var o=e.getElementsByTagName("styleUrl")[0].textContent;if(o){var l=t.querySelectorAll(o+" Pair");l.length>0&&Array.prototype.forEach.call(l,(function(e){var n=e.querySelector("key");if(n&&"normal"==n.textContent){var o=e.querySelector("styleUrl").textContent,style=t.querySelector(o);try{r="#"+style.querySelector("IconStyle color").textContent.substr(0,6)}catch(e){r=m}}}))}}catch(t){console.log("#category read error"),console.log(t),console.log(e)}return{name:n,color:r,iconUrl:void 0}}},199:function(e,t){},205:function(e,t,n){"use strict";n.r(t);var r=[function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("このサイトのソースコードはオープンに公開しております。開発にご協力いただける方は、"),t("a",{attrs:{href:"https://github.com/codeforjapan/mapprint"}},[this._v("Code for Japan の Github リポジトリ")]),this._v("から、開発にご参加ください。JavaScript や Leaflet などの経験がある方、大歓迎です。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"logo"},[t("img",{attrs:{src:n(186)}})])}],o=(n(111),n(112),n(15),n(14),n(27),n(41)),l=(n(42),n(5));n(58),n(187),n(191);var c,d=n(193).crc16,m={props:["map_config"],computed:{center:function(){return this.map_config.center},inBoundsMarkers:function(){var e=this,t=[];return this.layers.map((function(n){n.source.show&&n.markers.map((function(marker){e.bounds&&c.inBounds(marker.feature.geometry.coordinates,e.bounds)&&t.push(marker)}))})),t},displayMarkersGroupByCategory:function(){return this.inBoundsMarkers.reduce((function(e,t){var n=e.find((function(g){return g.name===t.category}));return n||(n={name:t.category,prop:t.category,markers:[]},e.push(n)),n.markers.push(t),e}),[])}},data:function(){return{layers:[],map:null,bounds:null,updated_at:null,isOpenLegend:!1,previous_hash:"",mapStyle:{version:8,sources:{OSM:{type:"raster",tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png","https://c.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:'Map data © <a href="http://openstreetmap.org/">OpenStreetMap</a>'}},layers:[{id:"OSM",type:"raster",source:"OSM",minzoom:0,maxzoom:22}]}}},methods:{load:function(e){var t=window.location.hash.substr(1),n=c.deserializeBounds(t);this.map=e.map,null!=n?this.map.fitBounds(n,{linear:!1}):null!=(n=c.deserializeBounds(this.map_config.default_hash))&&this.map.fitBounds(n,{linear:!1}),this.map.on("moveend",this.etmitBounds),this.etmitBounds()},etmitBounds:function(){this.bounds=this.map.getBounds(),this.setHash(this.bounds),this.$emit("bounds-changed")},setHash:function(e){var s=c.serializeBounds(e),path=location.pathname;s!=this.previous_hash&&window.history.pushState("","",path+"#"+s),this.previous_hash=s}},mounted:function(){var e=n(195).default,t=n(200).default;c=new e;var r={},m=this;this.map_config.sources.forEach((function(source){Object(l.a)(regeneratorRuntime.mark((function e(){var data,n,l,f,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m.updated_at=(dt=new Date).getFullYear()+"年"+("00"+(dt.getMonth()+1)).slice(-2)+"月"+("00"+dt.getDate()).slice(-2)+"日"+("00"+dt.getHours()).slice(-2)+"時"+("00"+dt.getMinutes()).slice(-2)+"分",e.next=3,t.get(source.url).text();case 3:data=e.sent,n=c.parse(source.type,data,m.map_config.layer_settings,source.updated_search_key),l=Object(o.a)(n,2),f=l[0],_=l[1],f.map((function(marker){r[marker.category]=!0})),source.updated_at=_,Object.keys(r).map((function(e){if(!m.map_config.layer_settings[e]){var t="#";t+=(parseInt(d(e.substr(0)),16)%32+64).toString(16),t+=(parseInt(d(e.substr(1)),16)%32+64).toString(16),t+=(parseInt(d(e.substr(2)),16)%32+64).toString(16);var n="#";n+=(parseInt(d(e.substr(0)),16)%32+128).toString(16),n+=(parseInt(d(e.substr(1)),16)%32+128).toString(16),n+=(parseInt(d(e.substr(2)),16)%32+128).toString(16),m.map_config.layer_settings[e]={name:e,color:t,bg_color:n}}})),m.layers.push({source:source,markers:f});case 9:case"end":return e.stop()}var dt}),e)})))()}))}},f=n(11),_={components:{PrintableMap:Object(f.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("client-only",[e.layers.length?n("div",[n("div",e._l(e.map_config.sources,(function(source){return n("label",{staticClass:"header-label"},[n("input",{directives:[{name:"model",rawName:"v-model",value:source.show,expression:"source.show"}],staticClass:"header-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(source.show)?e._i(source.show,null)>-1:source.show},on:{change:function(t){var n=source.show,r=t.target,o=!!r.checked;if(Array.isArray(n)){var l=e._i(n,null);r.checked?l<0&&e.$set(source,"show",n.concat([null])):l>-1&&e.$set(source,"show",n.slice(0,l).concat(n.slice(l+1)))}else e.$set(source,"show",o)}}}),e._v(e._s(source.title)),n("span",{staticClass:"source_updated"}),e._v(e._s(source.updated_at)),source.link?n("a",{attrs:{href:source.link,target:"blank"}},[e._v("[元の地図へ]")]):e._e()])})),0),n("div",{staticClass:"header-datetime"},[e._v("印刷日： "+e._s(e.updated_at))]),n("div",{staticClass:"map-outer"},[n("MglMap",{attrs:{mapStyle:e.mapStyle,center:e.center,zoom:15,preserveDrawingBuffer:"",sourceId:"basemap",id:"map"},on:{"update:mapStyle":function(t){e.mapStyle=t},"update:map-style":function(t){e.mapStyle=t},load:e.load}},[n("MglGeolocateControl"),n("div",{staticClass:"legend",class:{open:e.isOpenLegend}},[n("div",{staticClass:"legend-inner"},[e._l(e.map_config.layer_settings,(function(t,r){return n("div",{staticClass:"legend-type"},[n("i",{class:[t.icon_class],style:{backgroundColor:t.color}}),n("span",{staticClass:"poi-type"},[e._v(e._s(r))])])})),n("div",{staticClass:"legend-trigger",class:{close:!e.isOpenLegend},on:{click:function(t){e.isOpenLegend=!e.isOpenLegend}}},[e.isOpenLegend?n("div",{staticClass:"legend-trigger-icon"},[n("i",{staticClass:"fas fa-caret-right"}),n("span",[e._v("とじる")])]):n("div",{staticClass:"legend-trigger-icon"},[n("i",{staticClass:"fas fa-caret-left"}),n("span",[e._v("凡例")])])])],2)]),e._l(e.layers,(function(t){return t.source.show?e._l(t.markers,(function(marker,t){return n("MglMarker",{key:t,attrs:{coordinates:marker.feature.geometry.coordinates}},[n("template",{slot:"marker"},[n("div",{staticClass:"marker"},[n("span",{style:{background:e.map_config.layer_settings[marker.category].color}},[n("i",{class:[e.map_config.layer_settings[marker.category].icon_class,e.map_config.layer_settings[marker.category].class],style:{backgroundColor:e.map_config.layer_settings[marker.category].color}}),n("b",{staticClass:"number",style:{background:e.map_config.layer_settings[marker.category].bg_color}},[e._v(e._s(e.inBoundsMarkers.indexOf(marker)+1))])])])]),n("MglPopup",[n("div",[n("div",{staticClass:"legend-type"},[n("i",{class:[e.map_config.layer_settings[marker.category].icon_class,e.map_config.layer_settings[marker.category].class],style:{backgroundColor:e.map_config.layer_settings[marker.category].color}}),n("span",{staticClass:"poi-type"},[e._v(e._s(marker.category))])]),n("p",[e._v("名称: "+e._s(marker.feature.properties.name))]),n("div",{staticClass:"legend-detail-content"},[n("p",{domProps:{innerHTML:e._s(marker.feature.properties.description?marker.feature.properties.description:"")}})])])])],2)})):e._e()}))],2)],1),n("div",e._l(e.displayMarkersGroupByCategory,(function(t){return n("section",[n("h2",{staticClass:"list-title"},[n("span",{staticClass:"list-title-mark",style:{backgroundColor:e.map_config.layer_settings[t.name].color}},[n("i",{class:e.map_config.layer_settings[t.name].icon_class})]),n("span",[e._v(e._s(t.name))])]),n("ul",{staticClass:"list-items grid-noGutter"},e._l(t.markers,(function(marker){return n("li",{staticClass:"col-12_xs-6"},[n("span",{staticClass:"item-number"},[e._v(e._s(e.inBoundsMarkers.indexOf(marker)+1))]),n("span",{staticClass:"item-name"},[e._v(e._s(marker.feature.properties.name))])])})),0)])})),0)]):e._e()])}),[],!1,null,null,null).exports,VueQrcode:n(201).a},data:function(){return{map_config:n(184)("./"+this.$nuxt.$route.params.map),isOpenExplain:!1,fullURL:null}},methods:{updateQRCode:function(){this.fullURL=location.href}},mounted:function(){this.fullURL=location.href},head:function(){return{title:this.map_config.map_title,script:[{src:"https://kit.fontawesome.com/9b0eb4b9b8.js",crossorigin:"anonymous","data-n-head":!1}],meta:[{hid:"description",name:"description",content:this.map_config.map_description},{hid:"og:image",property:"og:image",content:"https://codeforjapan.github.io/mapprint/images/"+(this.map_config.map_image?this.map_config.map_image:"logo.png")}]}}},h=Object(f.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout-container-inner grid"},[n("aside",{staticClass:"not_print_area col-12_md-3",attrs:{id:"explain"}},[n("h2",{staticClass:"explain-title-pc"},[e._v("このサイトについて")]),n("div",{staticClass:"explain-title-sp",on:{click:function(t){e.isOpenExplain=!e.isOpenExplain}}},[e._v("このサイトについて")]),n("div",{staticClass:"explain",class:{open:e.isOpenExplain}},[e.map_config?n("p",[e._v(e._s(e.map_config.map_description))]):e._e(),e._m(0)])]),n("main",{staticClass:"sheet col-12_md-9"},[n("header",{staticClass:"header"},[n("div",{staticClass:"qrcode"},[n("vue-qrcode",{attrs:{value:e.fullURL,tag:"img"}})],1),n("div",{staticClass:"banner"},[e._m(1),e.map_config?n("h1",{staticClass:"title"},[e._v(e._s(e.map_config.map_title))]):e._e()])]),n("div",{attrs:{id:"content"}},[n("div",{attrs:{id:"page"}},[n("div",{staticClass:"print_area",attrs:{id:"date"}}),e.map_config?n("printable-map",{attrs:{map_config:e.map_config},on:{"bounds-changed":e.updateQRCode}}):e._e()],1),n("div",{staticClass:"print_area",attrs:{id:"footer"}})])])])}),r,!1,null,null,null);t.default=h.exports}}]);